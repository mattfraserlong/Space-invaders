
<html>
    <!--video here: https://sites.google.com/site/wecanprogramcom/html-and-javascript/web-development-level2/lesson-2-creating-a-game-loop-and-handling-movement-->
<head>
<style> /*CSS for sprites*/
#hero {
  background: #ff0000;
  width: 20px;
  height: 20px;
  position: absolute;
}
</style>
</head>
<body>
<div id="hero"></div><!--div for hero sprite-->
<script>
//variables
var LEFT_KEY = 37;
var UP_KEY = 38;
var RIGHT_KEY = 39;
var DOWN_KEY = 40;
var HERO_MOVEMENT = 5;

var lastLoopRun = 0;

//creating hero object and its properties    
var hero = new Object();
hero.element = 'hero';
hero.x = 250;
hero.y = 460;
    
//creating controller object
var controller = new Object();

//handling keypresses    
function toggleKey(keyCode, isPressed) {
  if (keyCode == LEFT_KEY) {
    controller.left = isPressed;
  }
  if (keyCode == RIGHT_KEY) {
    controller.right = isPressed;
  }
  if (keyCode == UP_KEY) {
    controller.up = isPressed;
  }
  if (keyCode == DOWN_KEY) {
    controller.down = isPressed;
  }
}

function setPosition(sprite) {
  var e = document.getElementById(sprite.element);
  e.style.left = sprite.x + 'px';
  e.style.top = sprite.y + 'px';
}

function handleControls() {
  if (controller.up) {
    hero.y -= HERO_MOVEMENT;
  }
  if (controller.down) {
    hero.y += HERO_MOVEMENT;
  }
  if (controller.left) {
    hero.x -= HERO_MOVEMENT;
  }
  if (controller.right) {
    hero.x += HERO_MOVEMENT;
  }
}

function showSprites() {
  setPosition(hero);
}

function loop() {
  if (new Date().getTime() - lastLoopRun > 10) {
    handleControls();
    showSprites();
    
    lastLoopRun = new Date().getTime();
  }
  setTimeout('loop();', 2);
}

document.onkeydown = function(evt) {
  toggleKey(evt.keyCode, true);
};

document.onkeyup = function(evt) {
  toggleKey(evt.keyCode, false);
};

loop();

</script>
</body>
</html>